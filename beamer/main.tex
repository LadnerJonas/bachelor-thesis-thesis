%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TUM-Vorlage: Präsentation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Rechteinhaber:
%     Technische Universität München
%     https://www.tum.de
%.
% Gestaltung:
%     ediundsepp Gestaltungsgesellschaft, München
%     http://www.ediundsepp.de
%
% Technische Umsetzung:
%     eWorks GmbH, Frankfurt am Main
%     http://www.eworks.de
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Zur Wahl des Seitenverhältnisses bitte einen der beiden folgenden Befehle
% auskommentieren und den ausführen lassen:
\input{Ressourcen/Praesentation/Praeambel4zu3.tex} % Seitenverhältnis 4:3
%\input{Ressourcen/Praesentation/Praeambel16zu9.tex} % Seitenverhältnis 16:9
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{Einstellungen.tex}                    % !!! DATEI ANPASSEN !!!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\PersonTitel}{}
\newcommand{\Datum}{11.03.2025}

\renewcommand{\PraesentationFusszeileZusatz}{| Bachelor Thesis: Implementing an Efficient Shuffle Operator for Streaming Database Systems%| Infos mit Strich trennen
}

\title{Implementing an Efficient Shuffle Operator for Streaming Database Systems}
\author{\PersonTitel{} \PersonVorname{} \PersonNachname}
\institute[]{\UniversitaetName}
\date[\Datum]{Garching, 11.03.2025} \subject{Implementing an Efficient Shuffle Operator for Streaming Database Systems}

% custom
\def\imgpath{figures}
\usepackage{pgfplots}
\usepackage{subcaption}
\providecommand{\mathdefault}[1]{#1}

\input{Ressourcen/Praesentation/Anfang.tex}

\PraesentationMasterStandard

\PraesentationTitelseite

% \input{.
%   % !!! NICHT ENTFERNEN !!!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FOLIENSTIL: Standard% Fügt die Startseite ein%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Beispielfolien                                  %%
%   /PraesentationBeispiele.tex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FOLIENSTIL: Standard mit Lehrstuhl-, Fakultäts- und Universitätsnamen im
% Kopfbereich links
% \PraesentationMasterKopfzeileDreizeiler

% \PraesentationTitelseite

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FOLIENSTIL: Weisse Schrift auf blauem Grund
%\PraesentationMasterWeissBlau

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Startseiten                                     %%

% Setzt die Startseite auf eine mit Flaggen als Hintergrund:
%\PraesentationStartseiteFlaggen

% Setzt die Startseite auf eine mit mit einer Zeichnung des TUM-Uhrenturms:
%\PraesentationStartseiteUhrenturm

% Setzt die Startseite auf eine ohne Hintergrund:
%\PraesentationStartseiteLeer

% \PraesentationTitelseite % Fügt die Startseite ein
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \begin{frame}
% 	\PraesentationUeberschriftZweizeilig{Präsentationsmuster}{kann auch als Kapiteltrenner verwendet werden}
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FOLIENSTIL: Weisse Schrift auf schwarzem Grund
% \PraesentationMasterWeissSchwarz

% \begin{frame}
%   \frametitle{Content}
%   \tableofcontents
% \end{frame}

\section{Introduction}
\begin{frame}{Problem Setting}
  \textbf{Key Contribution:}
  Efficient, multithreaded shuffle operator implementations.

  \textbf{Shuffle-Simulation Process:}
  \begin{enumerate}
    \item \textbf{Tuple Generation:}
          Randomly generated tuples with 32-bit keys and optional data fields.
    \item \textbf{Data Shuffle:}
          Tuples stored in partition buckets using slotted pages.
    \item \textbf{Storing on Slotted Pages:}
          Thread-local vs.
          shared (locking/lock-free) write-out strategies.
  \end{enumerate}
\end{frame}

\section{Implementation}
\begin{frame}{Naive approach: \emph{OnDemand}}
  \begin{itemize}
    \item \textbf{OnDemand:}
          Tuples are directly written to the partition buckets.
    \item \textbf{Problems:}
          \begin{itemize}
            \item High contention on partition buckets.
          \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Optimized approach: \emph{Smb}}
  \begin{itemize}
    \item \textbf{Software Managed Buffers (SMBs):}
          \begin{itemize}
            \item Cacheline-sized, thread-local buffers for each partition.
            \item Flush when buffer is full.
          \end{itemize}
    \item \textbf{Problems:}
          \begin{itemize}
            \item High contention on partition buckets.
          \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle<1>{{Histogram-based approach: \emph{Radix}}}
  \frametitle<2>{{Histogram-based approaches: \emph{Radix} and \emph{Hybrid}}}
  \begin{itemize}
    \item \textbf{Histogram:}
          \begin{itemize}
            \item Thread-local histograms for each partition.
            \item Flush when histogram is full.
          \end{itemize}
    \item \textbf{Problems:}
          \begin{itemize}
            \item High contention on histograms.
          \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Reducing contention: \emph{CmpProcessingUnits}}

\end{frame}
\begin{frame}{Avoiding contention: \emph{LocalPagesAndMerge}}

\end{frame}
\section{Evaluation}
\begin{frame}{Evaluation}
  \begin{figure}[h]
    \centering
    \begin{subfigure}{.49\textwidth}
      \centering
      \resizebox{\linewidth}{!}{\input{\imgpath/evaluation/Tuples_per_Second-Tuple16-Partitions2.pgf}}
    \end{subfigure}
    \begin{subfigure}{.49\textwidth}
      \centering
      \resizebox{\linewidth}{!}{\input{\imgpath/evaluation/Tuples_per_Second-Tuple16-Partitions8.pgf}}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
      \centering
      \resizebox{.85\linewidth}{!}{\input{\imgpath/evaluation/legend.pgf}}
    \end{subfigure}
    \caption[Shuffle Benchmark Plots for Tuple of 16B with 2 and 8 Partitions]{Benchmark Plots for Tuple of 16B with 2 and 8 Partitions}
    \label{plot-shuffle-16B-2-8}
  \end{figure}
\end{frame}

\begin{frame}{Evaluation}
  \begin{figure}[h]
    \centering
    \begin{subfigure}{.49\textwidth}
      \centering
      \resizebox{\linewidth}{!}{\input{\imgpath/evaluation/Tuples_per_Second-Tuple4-Partitions32.pgf}}
    \end{subfigure}
    \begin{subfigure}{.49\textwidth}
      \centering
      \resizebox{\linewidth}{!}{\input{\imgpath/evaluation/Tuples_per_Second-Tuple4-Partitions1024.pgf}}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
      \centering
      \resizebox{.85\linewidth}{!}{\input{\imgpath/evaluation/legend.pgf}}
    \end{subfigure}
    \caption[Shuffle Benchmark Plots for Tuple of 4B with 32 and 1024 Partitions]{Benchmark Plots for Tuple of 4B with 32 and 1024 Partitions}
    \label{plot-shuffle-4B-32-1024}
  \end{figure}
\end{frame}

\begin{frame}{Evaluation}
  \begin{figure}[h]
    \centering
    \begin{subfigure}{.49\textwidth}
      \centering
      \resizebox{\linewidth}{!}{\input{\imgpath/evaluation/Tuples_per_Second-Tuple16-Partitions32.pgf}}
    \end{subfigure}
    \begin{subfigure}{.49\textwidth}
      \centering
      \resizebox{\linewidth}{!}{\input{\imgpath/evaluation/Tuples_per_Second-Tuple16-Partitions1024.pgf}}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
      \centering
      \resizebox{.85\linewidth}{!}{\input{\imgpath/evaluation/legend.pgf}}
    \end{subfigure}
    \caption[Shuffle Benchmark Plots for Tuple of 16B with 32 and 1024 Partitions]{Benchmark Plots for Tuple of 16B with 32 and 1024 Partitions}
    \label{plot-shuffle-16B-32-1024}
  \end{figure}
\end{frame}

\begin{frame}{Evaluation}
  \begin{figure}[h]
    \centering
    \begin{subfigure}{.49\textwidth}
      \centering
      \resizebox{\linewidth}{!}{\input{\imgpath/evaluation/Tuples_per_Second-Tuple100-Partitions32.pgf}}
    \end{subfigure}
    \begin{subfigure}{.49\textwidth}
      \centering
      \resizebox{\linewidth}{!}{\input{\imgpath/evaluation/Tuples_per_Second-Tuple100-Partitions1024.pgf}}
    \end{subfigure}
    \begin{subfigure}{\textwidth}
      \centering
      \resizebox{.85\linewidth}{!}{\input{\imgpath/evaluation/legend.pgf}}
    \end{subfigure}
    \caption[Shuffle Benchmark Plots for Tuple of 100B with 32 and 1024 Partitions]{Benchmark Plots for Tuple of 100B with 32 and 1024 Partitions}
    \label{plot-shuffle-100B-32-1024}
  \end{figure}
\end{frame}
\begin{frame}{Peak Heap Memory}
  \begin{figure}[h]
    \centering
    \resizebox{.85\linewidth}{!}{\input{\imgpath/evaluation/memory_plot-16B-P32-Th40.pgf}}
    \caption[Peak Heap Memory Benchmark Plot]{Peak Heap Usage when using 32 Partitions, 40 Threads and 67.2 Mio.
      16B Tuples (1 GiB)} \label{plot-heap-16B-P32-Th40}
  \end{figure}
\end{frame}

\begin{frame}{Comparison with Apache Flink}
  \begin{figure}[h]
    \centering
    \resizebox{.7\linewidth}{!}{\input{\imgpath/evaluation/apache-flink-comparison.pgf}}
    \caption[Tuples per Second Comparison Plot with Apache Flink]{Tuples per Second Comparision when using 1024 Partitions}
    \label{plot-apache-flink-comparison}
  \end{figure}
\end{frame}

\section{Conclusion}
\begin{frame}{Conclusion and Future Work}
  \textbf{Conclusion:}

  \begin{itemize}
    \item Thread-local slotted pages are optimal for low partition counts.
    \item SMB-based methods scale best for high partition counts.
  \end{itemize}

  \textbf{Future Work:}
  \begin{itemize}
    \item Further reducing contention on machines with 20+ cores.
    \item Evaluate the implementations in a real-world streaming system.
  \end{itemize}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document} % !!! NICHT ENTFERNEN !!!
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
